# 使用Backbone.js创建通讯录：Part 2

> 原文地址：http://code.tutsplus.com/tutorials/build-a-contacts-manager-using-backbonejs-part-2--net-24315

在part 1里谈到了Backbone模型、集合和视图的基本用法和怎样使用绑定了集合的master视图渲染单独的联系人视图。

这次来看下如何根据用户输入来显示特定的视图，和怎样添加一个路由，让应用程序能响应一些URL功能。

我们需要在part 1的基础上进行，如果没有读过part 1，强烈建议先[读一下](http://stenders.github.io/posts/build-contact-manager-with-backbone.html)。

## 响应用户输入

可以你已经注意到了，在part 1里每条视图数据里都有一个```type```属性，它将数据按照朋友、家庭、同事进行了分组。我们往master视图里增加一个选择框，以便于让用户能够根据这些属性来过滤查看数据。

可以在HTML里硬编码进来一个选择菜单并手动添加各种不同的分组类型。但是这很不灵活：如果以后添加了新属性的数据怎么办？或者删除了某个类型的所有数据怎么办？我们的程序现在还没有添加和删除数据的功能（剧透下，part 3里会增加此功能），但是即使在程序前期，最好还是先考虑到这些情况。

很容易就能根据现有的属性动态地创建一个选择框元素。现在先往前面的HTML里添加一小段代码；在联系人容器前面增加下面的代码：
```
<header>
  <div id="filter">
    <label>Show me:</label>
  </div>
</header>
```
就这些！一个```<header>```元素作为容器，里面又是一个带有```id```属性的容器，再往里是一个```<label>```和介绍文字。

下面来创建```<select>```元素。首先往```DirectoryView```的master视图里增加两个方法；第一个是提取特定的类型，第二个来创建一个下拉菜单。两个方法应放在视图最下面。
<script type="text/javascript">
getTypes: function () {
  return _.uniq(this.collection.pluck("type"), false, function (type) {
    return type.toLowerCase();
  });
},
 
createSelect: function () {
  var filter = this.el.find("#filter"),
    select = $("<select/>", {
      html: "<option value='all'>All</option>"
    });

  _.each(this.getTypes(), function (item) {
    var option = $("<option/>", {
      value: item.toLowerCase(),
      text: item.toLowerCase()
    }).appendTo(select);
  });
  return select;
}
</script>
第一个方法里，```getTypes()```返回一个由Underscore的```uniq()```方法生成的数组。```uniq()```方法接受一个数组作为参数并返回一个只包含唯一元素的新数组。传到```uniq()```方法里的数组是由Backbone的```pluck()```方法生成的。```pluck()```方法是将视图集合中某一类型的视图提取出来的一个简单方法。这里我们感兴趣的类型是```type```属性。

为了防止出现大小写问题，这里统一将类型小写处理。在```uniq()```方法里，还提供了一个遍历方法作为第三个参数，它用来将所有的type属性转为小写，它接受当前项作为参数，在函数体内直接返回了其小写格式。```uniq()```方法里传递的第二个参数```false```是用来指明待处理的数组是否已经过排序。